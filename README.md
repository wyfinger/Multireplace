##MultiReplace - Word макрос поиска и замены текста##

**История**

2015-03-08 - добавлена поддержка колонтитулов.

Возможности, предоставляемые макросом:

**1. Поиск/замена по списку, т.к. пакетный поиск**

Когда нужно поменять сразу множество значений в документе очень удобно пользоваться мультипоиском, достаточно ввести в поле для ввода набор строк поиска (выражений или масок, если используются регулярные выражения или подстановочные символы), разнеся их на разные строки. Во второе поле ввода необходимо ввести строки замены;

**2. Поиск/замена по регулярному выражению**

Используется объект VBScript.RegExp с присущими ему недостатками, так для замены на подвыражения используется знак "$" вместо общепринятого символа "\"; Необходимо учитывать, что при использовании регулярных выражений замена осуществляется с конца документа в начало. Это сделано, чтобы сократить вычислительную работу.

Общая информация: [http://ru.wikipedia.org/wiki/Регулярные_выражения](http://ru.wikipedia.org/wiki/Регулярные_выражения)

Калькулятор регулярных выражений: [http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)

**3. Поиск/замена по подстановочным символам**

Регулярные выражения - это очень удобно и максимально гибко, но сложно, поэтому ребята из Microsoft реализовали свое убогое подобие регулярных выражений в семействе продуктов Office под названием Подстановочные символы. Это похоже на маски поиска файлов, где символ "?" обозначает один любой символ, а символ "*" - любое количество любых символов, в том числе и ноль. И так далее. Использование подстановочных символов может быть полезно и удобно, но нужно иметь ввиду, что даже на простых выражениях Word нередко выдает фразу типа "Слишком сложное выражение для поиска", нужно всегда проверять. Кроме того, поиск с подстановочными символами всегда регистрозависимый;

 Общая информация: [http://office.microsoft.com/ru-ru/word-help/HA001230392.aspx](http://office.microsoft.com/ru-ru/word-help/HA001230392.aspx)

**4. Обработка файлов по списку**

Если требуется произвести (замену в тексте) сразу нескольких документов открывать каждый из них, заполнять поля ввода и осуществлять замену весьма неудобно. Макрос позволяет осуществлять потоковую обработку группы файлов. Чтобы использовать этот режим щелкните по кнопке "Несколько файлов", введите в поле ввода список файлов с полными путями (по файлу на строке, или просто перетащите файлы в окно из проводника).

После заполнения списка файлов окно можно закрыть, а в главном окне макроса нажать кнопку "Замена" (рядом с кнопкой "Несколько файлов"). При этом файлы будут открываться Word по очереди, в каждом будет осуществляться замена.

**5. Режим записи исправлений**

Макрос не обладает достаточным уровнем интерактивности, но иногда требуется посмотреть и проверить что и где было заменено, для таких случаев имеется галка "Включать запись изменений". Если эта галка установлена при обработке документа.
##
**Установка**

Макрос состоит из 3 объектов: модуль SRUnit и две формы SRForm и SRFiles. Все эти три объекта необходимо перенести в шаблон Normal. Для этого открываем редактор Visual Basic for Application и перетаскиваем названные выше модули на шаблон Normal.

Также потребуется включить выполнение макросов, иначе с пакетной обработкой файлов будут Проблемы. Включить выполнение макросов нужно в меню "Параметры->Центр управления безопасностью", далее выбираем кнопку "Параметры центра управления безопасностью->Параметры макросов", нас интересует режим "Включить все макросы".

> Исправить здесь ссылки !!!

**Видеоинструкция по установке:** [http://github.com/wyfinger/Multireplace/raw/master/video/Install.mp4](http://github.com/wyfinger/Multireplace/raw/master/video/Install.mp4)

**Видеоинструкция по включению макросов:** [http://bit.ly/JORL58](http://bit.ly/JORL58)

**Сам макрос:** [http://bit.ly/JORL58](http://bit.ly/JORL58)